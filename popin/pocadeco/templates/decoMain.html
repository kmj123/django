{% extends 'header_login.html'%}
{% load static %}
<!--ÏÉÅÎã® Ìó§Îçî-->
{%block content%}

<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="/static/css/mypage.css">
        <title>Ìè¨ÌÜ†Ïπ¥Îìú Íæ∏ÎØ∏Í∏∞ Í≤åÏãúÌåê</title>
    </head>
    <style>

        .container {
            max-width: 1400px;
            margin: 0 auto;
            margin-top: 20px;
            
        }

        .main-content {
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }

        .sidebar {
            width: 300px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            height: fit-content;
        }

        .content {
            flex: 1;
        }

        .navbar {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 14px;
            width: 85px;
            height: 67px;
            border: none;
            border-radius: 100px;
        }

        .btn img{
            width:100%;
            height:100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn.active {
            background: linear-gradient(45deg, #764ba2, #667eea);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.6);
        }

        .upload-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            padding: 12px 24px;
            font-size: 16px;
            position: fixed;
            bottom: 7%;
            right: 32px;
            z-index: 999;
        }

        .search-results {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            display: none;
        }

        .search-results.show {
            display: block;
        }

        .search-item {
            padding: 12px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background 0.3s ease;
        }

        .search-item:hover {
            background: #f8f9fa;
        }

        .search-item:last-child {
            border-bottom: none;
        }

        .selected-artist {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            font-weight: bold;
        }

        .remove-artist {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 18px;
            padding: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sort-section {
            margin-bottom: 25px;
        }

        .sort-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .sort-options select{
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 15px;
            color: #868686;
        }

        .sort-option {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: background 0.3s ease;
        }

        .sort-option:hover {
            background: #f8f9fa;
        }

        .sort-option input[type="radio"] {
            width: 18px;
            height: 18px;
            accent-color: #667eea;
        }

        .sort-option label {
            cursor: pointer;
            font-weight: 500;
        }

        .search-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .filter-section {
            margin-bottom: 20px;
        }

        .filter-title {
            font-size: 18px;
            font-weight: bold;
            margin: 15px 0;
            color: #333;
        }

        .group-item {
            margin-bottom: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }

        .group-header {
            padding: 12px;
            background: #f8f9fa;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            transition: background 0.3s ease;
        }

        .group-header:hover {
            background: #e9ecef;
        }

        .group-header.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .members-list {
            padding: 10px;
            background: white;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .members-list.open {
            max-height: 250px;
            overflow-y: auto;
        }

        .member-item {
            padding: 8px 12px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .member-item:hover {
            background: #e9ecef;
        }

        .member-item.selected {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(187px, 1fr));
            gap: 20px;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            min-height: 400px;
        }
        .photo-grid:has(.no-results) {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 300px;
        }

        .photo-card {
            background: #ffff;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            padding:15px;
        }

        .photo-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        .photo-image {
            width: 100%;
            height: 273px;
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #666;
            position: relative;
            overflow: hidden;
            border-radius:8px;
        }

        .photo-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-info {
            padding: 15px;
        }

        .photo-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
        }

        .photo-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 12px;
            color: #666;
        }

        .photo-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 10px;
        }

        .tag {
            padding: 4px 8px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
        }

        .photo-stats {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #888;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .arrow {
            transition: transform 0.3s ease;
        }

        .arrow.rotated {
            transform: rotate(180deg);
        }

        .no-results {
            text-align: center;
            color: #666;
            font-size: 18px;
            padding: 40px;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            .content{
                width:100%;
            }
            
            .sidebar {
                width: 100%;
            }
            
            .navbar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .sort-buttons {
                justify-content: center;
            }
            
            .photo-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            .photo-card{
                width:100%;
            }
        }
                /* ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò */
    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin-top: 40px;
    }

    .page-btn {
      padding: 10px 15px;
      border: 2px solid #667eea;
      border-radius: 10px;
      background: white;
      color: #667eea;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .page-btn:hover,
    .page-btn.active {
      background: #667eea;
      color: white;
      transform: translateY(-2px);
    }

    .page-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    </style>
</head>
<body>
    <div class="container">
        <div class="main-content">
            <div class="sidebar">
                <div class="search-section">
                    <h3 class="filter-title" id="select_artist">ÏïÑÌã∞Ïä§Ìä∏ ÏÑ†ÌÉù</h3>
                    <input type="text" class="search-input" placeholder="Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî" id="artistSearch">
                    <div class="search-results" id="searchResults"></div>
                    <div id="selectedArtist"></div>
                </div>
                <div class="filter-section" id="selectmember" style="display:none;">
                    <h3 class="filter-title">Î©§Î≤Ñ ÌïÑÌÑ∞</h3>
                    <div id="groupsList">
                        <!-- ÏÑ†ÌÉùÎêú Í∑∏Î£πÏùò Î©§Î≤Ñ Î¶¨Ïä§Ìä∏Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                    </div>
                </div>

                <div class="sort-section">
                    <h3 class="filter-title">Ï†ïÎ†¨ ÏòµÏÖò</h3>
                    <div class="sort-options">
                        <select>
                            <option value="latest">ÏµúÏã†Ïàú</option>
                            <option value="popular">Ïù∏Í∏∞Ïàú</option>
                            <option value="views">Í¥ÄÏã¨ÎèÑÏàú</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn" style="width:100%;">Í≤ÄÏÉâÌïòÍ∏∞</button>
            </div>
            <div class="content">
                <div class="navbar">
                    <div class="navbar-header">
                        <h1>Ìè¨ÌÜ†Ïπ¥Îìú Íæ∏ÎØ∏Í∏∞ Í≤åÏãúÌåê</h1>
                        <p>ÎÇòÎßåÏùò Ìè¨ÌÜ†Ïπ¥ÎìúÎ•º Íæ∏ÎØ∏Í≥† Í≥µÏú†Ìï¥Î≥¥ÏÑ∏Ïöî!</p>
                    </div>
                    
                </div>

                <div class="photo-section">
                    <!-- photoGrid ÏïàÏóê ÏßÅÏ†ë Î†åÎçîÎßÅ -->
                    <div class="photo-grid" id="photoGrid">
                        <!-- JSÏóêÏÑú Î†åÎçîÎßÅ -->
                    </div>
                </div>
                <div class="pagination">
                    <button class="page-btn" disabled>‚Äπ</button>
                    <a href="#" class="page-btn active">1</a>
                    <a href="#" class="page-btn">2</a>
                    <a href="#" class="page-btn">3</a>
                    <a href="#" class="page-btn">4</a>
                    <a href="#" class="page-btn">5</a>
                    <button class="page-btn">‚Ä∫</button>
                    </div>
                </div>
            </div>
        </div>
        <button class="btn upload-btn"><img src="/static/images/write_icon.png/"></button>
    </div>

    <script>
        // ÏÉòÌîå Îç∞Ïù¥ÌÑ∞
        const sampleData = [
            {
                id: 1,
                title: "ÏßÄÎØº Ìè¨ÌÜ†Ïπ¥Îìú Íæ∏ÎØ∏Í∏∞",
                author: "ARMY_123",
                date: "2024-07-01",
                views: 1250,
                likes: 89,
                group: "BTS",
                member: "ÏßÄÎØº",
                image: null
            },
            {
                id: 2,
                title: "ÏúàÌÑ∞ ÏÉùÏùº Í∏∞ÎÖê Ïπ¥Îìú",
                author: "MY_Winter",
                date: "2024-06-30",
                views: 890,
                likes: 156,
                group: "aespa",
                member: "ÏúàÌÑ∞",
                image: null
            },
            {
                id: 3,
                title: "Ï†ïÍµ≠ Í≥®Îì† ÌÖåÎßà",
                author: "JK_Golden",
                date: "2024-06-29",
                views: 2100,
                likes: 234,
                group: "BTS",
                member: "Ï†ïÍµ≠",
                image: null
            },
            {
                id: 4,
                title: "Ïπ¥Î¶¨ÎÇò Î∏îÎûôÎßòÎ∞î Ïª®ÏÖâ",
                author: "aespa_fan",
                date: "2024-06-28",
                views: 1850,
                likes: 198,
                group: "aespa",
                member: "Ïπ¥Î¶¨ÎÇò",
                image: null
            },
            {
                id: 5,
                title: "RM Ïù∏ÎîîÍ≥† Ïï®Î≤î ÌÖåÎßà",
                author: "Namjoon_Art",
                date: "2024-06-27",
                views: 1420,
                likes: 167,
                group: "BTS",
                member: "RM",
                image: null
            },
            {
                id: 6,
                title: "ÏßÄÏ†§ ÌûôÌï© Î∞îÏù¥Î∏å",
                author: "Giselle_Hip",
                date: "2024-06-26",
                views: 920,
                likes: 112,
                group: "aespa",
                member: "ÏßÄÏ†§",
                image: null
            }
        ];

        const groups = {
            "BTS": ["RM", "ÏßÑ", "ÏäàÍ∞Ä", "Ï†úÏù¥Ìôâ", "ÏßÄÎØº", "Î∑î", "Ï†ïÍµ≠"],
            "aespa": ["Ïπ¥Î¶¨ÎÇò", "ÏßÄÏ†§", "ÏúàÌÑ∞", "ÎãùÎãù"],
            "BLACKPINK": ["ÏßÄÏàò", "Ï†úÎãà", "Î°úÏ†ú", "Î¶¨ÏÇ¨"],
            "NewJeans": ["ÎØºÏßÄ", "ÌïòÎãà", "Îã§ÎãàÏóò", "Ìï¥Î¶∞", "ÌòúÏù∏"],
            "IVE": ["ÏïàÏú†ÏßÑ", "Í∞ÄÏùÑ", "Î†àÏù¥", "ÏõêÏòÅ", "Î¶¨Ï¶à", "Ïù¥ÏÑú"]
        };

        let currentData = [...sampleData];
        let currentSort = 'latest';
        let selectedGroup = null;
        let selectedMember = null;

        // DOM ÏöîÏÜåÎì§
        const photosection = document.getElementById('photo-section');
        const photoGrid = document.getElementById('photoGrid');
        const groupsList = document.getElementById('groupsList');
        const artistSearch = document.getElementById('artistSearch');
        const searchResults = document.getElementById('searchResults');
        const selectedArtistDiv = document.getElementById('selectedArtist');
        const sortOptions = document.querySelectorAll('input[name="sort"]');
        const selectmember = document.getElementById('selectmember');

        // Ï¥àÍ∏∞Ìôî
        function init() {
            renderPhotos(currentData);
            setupEventListeners();
        }

        // ÏïÑÌã∞Ïä§Ìä∏ Í≤ÄÏÉâ Í≤∞Í≥º Î†åÎçîÎßÅ
        function renderSearchResults(searchTerm) {
            if (!searchTerm.trim()) {
                searchResults.classList.remove('show');
                return;
            }

            const filteredGroups = Object.keys(groups).filter(group => 
                group.toLowerCase().includes(searchTerm.toLowerCase())
            );

            if (filteredGroups.length === 0) {
                searchResults.innerHTML = '<div class="search-item">Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>';
            } else {
                searchResults.innerHTML = filteredGroups.map(group => `
                    <div class="search-item" data-group="${group}">
                        ${group}
                    </div>
                `).join('');
            }
            
            searchResults.classList.add('show');
        }

        // ÏÑ†ÌÉùÎêú ÏïÑÌã∞Ïä§Ìä∏ ÌëúÏãú
        function showSelectedArtist(group) {
            selectedArtistDiv.innerHTML = `
                <div class="selected-artist">
                    <span>${group}</span>
                    <button class="remove-artist" onclick="removeSelectedArtist()">√ó</button>
                </div>
            `;
            artistSearch.value = '';
            searchResults.classList.remove('show');
            selectmember.style.display="block";
            renderMembersList(group);
        }

        // ÏÑ†ÌÉùÎêú ÏïÑÌã∞Ïä§Ìä∏ Ï†úÍ±∞
        function removeSelectedArtist() {
            selectedArtistDiv.innerHTML = '';
            groupsList.innerHTML = '';
            selectedGroup = null;
            selectedMember = null;
            currentData = filterData();
            renderPhotos(currentData);
        }

        // Î©§Î≤Ñ Î¶¨Ïä§Ìä∏ Î†åÎçîÎßÅ
        function renderMembersList(group) {
            groupsList.innerHTML = `
                <div class="group-item">
                    <div class="members-list open">
                        <div class="member-item ${!selectedMember ? 'selected' : ''}" data-group="${group}" data-member="">
                            Ï†ÑÏ≤¥ Î©§Î≤Ñ
                        </div>
                        ${groups[group].map(member => `
                            <div class="member-item ${selectedMember === member ? 'selected' : ''}" data-group="${group}" data-member="${member}">
                                ${member}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Ìè¨ÌÜ†Ïπ¥Îìú Î†åÎçîÎßÅ
        function renderPhotos(data) {
            if (data.length === 0) {
                photoGrid.innerHTML = '<div class="no-results">Ï°∞Í±¥Ïóê ÎßûÎäî Ìè¨ÌÜ†Ïπ¥ÎìúÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }

            photoGrid.innerHTML = data.map(photo => `
                <div class="photo-card" data-id="${photo.id}">
                    <div class="photo-image">
                        ${photo.image ? `<img src="${photo.image}" alt="${photo.title}">` : 'üé® Ìè¨ÌÜ†Ïπ¥Îìú'}
                    </div>
                    <div class="photo-info">
                        <div class="photo-title">${photo.title}</div>
                        <div class="photo-meta">
                            <span>@${photo.author}</span>
                            <span>${photo.date}</span>
                        </div>
                        <div class="photo-tags">
                            <span class="tag">${photo.group}</span>
                            <span class="tag">${photo.member}</span>
                        </div>
                        <div class="photo-stats">
                            <div class="stat-item">
                                <span>üëÅÔ∏è</span>
                                <span>${photo.views.toLocaleString()}</span>
                            </div>
                            <div class="stat-item">
                                <span>‚ù§Ô∏è</span>
                                <span>${photo.likes}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        // Îç∞Ïù¥ÌÑ∞ Ï†ïÎ†¨
        function sortData(data, sortType) {
            const sorted = [...data];
            switch (sortType) {
                case 'latest':
                    return sorted.sort((a, b) => new Date(b.date) - new Date(a.date));
                case 'popularity':
                    return sorted.sort((a, b) => b.likes - a.likes);
                case 'views':
                    return sorted.sort((a, b) => b.views - a.views);
                default:
                    return sorted;
            }
        }

        // Îç∞Ïù¥ÌÑ∞ ÌïÑÌÑ∞ÎßÅ
        function filterData() {
            let filtered = [...sampleData];
            
            if (selectedGroup && selectedMember) {
                filtered = filtered.filter(photo => 
                    photo.group === selectedGroup && photo.member === selectedMember
                );
            } else if (selectedGroup) {
                filtered = filtered.filter(photo => photo.group === selectedGroup);
            }
            
            return sortData(filtered, currentSort);
        }

        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
        function setupEventListeners() {
            // Ï†ïÎ†¨ ÏòµÏÖò
            sortOptions.forEach(option => {
                option.addEventListener('change', (e) => {
                    currentSort = e.target.value;
                    currentData = filterData();
                    renderPhotos(currentData);
                });
            });

            // ÏïÑÌã∞Ïä§Ìä∏ Í≤ÄÏÉâ
            artistSearch.addEventListener('input', (e) => {
                renderSearchResults(e.target.value);
            });

            // Í≤ÄÏÉâ Í≤∞Í≥º ÌÅ¥Î¶≠
            searchResults.addEventListener('click', (e) => {
                if (e.target.classList.contains('search-item') && e.target.dataset.group) {
                    const group = e.target.dataset.group;
                    selectedGroup = group;
                    selectedMember = null;
                    showSelectedArtist(group);
                    currentData = filterData();
                    renderPhotos(currentData);
                }
            });

            // Î©§Î≤Ñ ÏÑ†ÌÉù
            groupsList.addEventListener('click', (e) => {
                if (e.target.classList.contains('member-item')) {
                    // Î©§Î≤Ñ ÏÑ†ÌÉù
                    document.querySelectorAll('.member-item').forEach(item => {
                        item.classList.remove('selected');
                    });
                    
                    e.target.classList.add('selected');
                    selectedMember = e.target.dataset.member || null;
                    
                    currentData = filterData();
                    renderPhotos(currentData);
                }
            });

            // Í≤ÄÏÉâÏ∞Ω Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Í≤ÄÏÉâ Í≤∞Í≥º Ïà®Í∏∞Í∏∞
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.search-section')) {
                    searchResults.classList.remove('show');
                }
            });

            // ÏóÖÎ°úÎìú Î≤ÑÌäº
            document.querySelector('.upload-btn').addEventListener('click', () => {
                location.href="{%url 'photocard:write' %}";
            });

            // Ìè¨ÌÜ†Ïπ¥Îìú ÌÅ¥Î¶≠
            photoGrid.addEventListener('click', (e) => {
                const card = e.target.closest('.photo-card');
                if (card) {
                    const photoId = card.dataset.id;
                    alert(`Ìè¨ÌÜ†Ïπ¥Îìú ID ${photoId} ÏÉÅÏÑ∏Î≥¥Í∏∞`);
                }
            });
        }

        // Ï¥àÍ∏∞Ìôî Ïã§Ìñâ
        init();
    </script>
{%endblock%}
</body>
</html>